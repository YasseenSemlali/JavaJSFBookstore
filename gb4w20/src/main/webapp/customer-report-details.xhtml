<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
Java Server Faces page that displays the customer report. 
This will display the total sales of the user along with the totals of each item sold. 
The user can select which user they would like to view via a drop down. 

@author Jeffrey Boisvert
-->
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                template="/templates/defaultTemplate.xhtml">
    <ui:define name="head">
        <title>#{msgs.clientReport}</title>
        <h:outputStylesheet library="css" name="report.css" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"></link>

    </ui:define>
    
    <f:metadata>
        <f:viewParam id="userId" name="userId" value="#{clientReportBackingBean.userId}" />
    </f:metadata>
    
    <ui:define name="content">
        <div class="jumbotron">
        <h1 class="report-title">#{msgs.clientReport}</h1>
        <h:form id="clientReportForm" >
                
            <div class="form-control">
                
                <h:outputLabel for="userSelect" value="#{msgs.clientName}"/>
                <h:selectOneMenu id="userSelect" class="custom-select" value = "#{clientReportBackingBean.userId}">
                    <f:selectItems value="#{clientReportBackingBean.users}" var="user" itemValue="#{user.userId}" itemLabel="#{user.firstName} #{user.lastName}"/>
                </h:selectOneMenu>
            </div>
            <div class="form-control">
                    <h:outputLabel for="startDateReport" value="#{msgs.startDate}"/>
                    <p:calendar class="datepicker" value="#{clientReportBackingBean.startDate}"
                        id="startDateReport" pattern="yyyy-MM-dd" mode="popup" showOn="button">
                    </p:calendar>
                </div>
            <div class="form-control">
                    <h:outputLabel for="endDateReport" value="#{msgs.endDate}"/>
                    <p:calendar class="datepicker" value="#{clientReportBackingBean.endDate}"
                        id="endDateReport" pattern="yyyy-MM-dd" mode="popup" showOn="button">
                    </p:calendar>
                </div>
            <h:commandButton class="btn btn-primary run-report-button" value="#{msgs.runReport}"
                             action="#{clientReportBackingBean.runReport}"/>

        </h:form>
        </div>
        <!-- Report --> 
        <div class="jumbotron">
             <h4>#{msgs.totalSalesLabel} $#{clientReportBackingBean.totalSales == null ? 0.00 : clientReportBackingBean.totalSales}</h4>
        </div>
        <div class="jumbotron">
              <h3>#{msgs.itemsPurchased}</h3>
              <h:panelGrid class="table table-hover" columns="2" border="1" rendered="#{not empty clientReportBackingBean.purchasedProducts}">
                  <h:panelGroup class="column-header">#{msgs.bookColumnName}</h:panelGroup>
                  <h:panelGroup class="column-header">#{msgs.saleTotal}</h:panelGroup>
                        <c:forEach items="#{clientReportBackingBean.purchasedProducts}" var="sales">
                            <h:panelGroup>#{sales.name}</h:panelGroup>
                            <h:panelGroup>$#{sales.amount}</h:panelGroup>
                        </c:forEach>
            </h:panelGrid>
        </div>
    </ui:define>
</ui:composition>
