<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
Java Server Faces page that displays the customer report. 
This will display the total sales of the user along with the totals of each item sold. 
The user can select which user they would like to view via a drop down. 

@author Jeffrey Boisvert
-->
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                template="/templates/defaultTemplate.xhtml">
    <ui:define name="head">
        <title>Customer report</title>
            <h:outputStylesheet library="css" name="carousel.css" />
    </ui:define>
    
    <f:metadata>
        <f:viewParam id="userId" name="userId" value="#{clientReportBackingBean.userId}" />
    </f:metadata>
    
    <ui:define name="content">
        <h1>#{msgs.clientReport}</h1>
        <h:form id="clientReportForm" >
            <h:panelGrid columns="3" cellpadding="1" border="0" cellspacing="10"
                         title="#{msgs.clientReport}">
                
                <f:facet name="header">
                    <h:outputText value="#{msgs.clientReportInstructions}" />
                </f:facet>
                <h:outputLabel value="#{msgs.clientName}"/>
                <h:selectOneMenu value = "#{clientReportBackingBean.userId}">
                    <f:selectItems value="#{clientReportBackingBean.users}" var="user" itemValue="#{user.userId}" itemLabel="#{user.firstName} #{user.lastName}"/>
                </h:selectOneMenu>
                
                <div>
                    <h:outputLabel value="#{msgs.startDate}"/>
                    <p:calendar value="#{clientReportBackingBean.startDate}"
                        id="startDateReport" pattern="yyyy-MM-dd" mode="popup" showOn="button">
                    </p:calendar>
                </div>
                <div>
                    <h:outputLabel value="#{msgs.endDate}"/>
                    <p:calendar value="#{clientReportBackingBean.endDate}"
                        id="endDateReport" pattern="yyyy-MM-dd" mode="popup" showOn="button">
                        <f:convertDateTime type="String"  dateStyle="short" pattern="yyyy-MM-dd" />
                    </p:calendar>
                </div>
            </h:panelGrid>
            <h:commandButton id="runReport" value="#{msgs.runReport}"
                             action="#{clientReportBackingBean.runReport}"/>
            

        </h:form>
        <!-- Report --> 
        <div>
             <h4>Total Sales: #{clientReportBackingBean.totalSales == null ? "No sales" : clientReportBackingBean.totalSales}</h4>
        </div>
        <div >
              <h3>#{msgs.itemsPurchasedByClient}</h3>
              <h:panelGrid columns="2" border="1" rendered="#{not empty clientReportBackingBean.purchasedProducts}">
                        <h:panelGroup>Item Name</h:panelGroup>
                        <h:panelGroup>Sale</h:panelGroup>
                        <c:forEach items="#{clientReportBackingBean.purchasedProducts}" var="sales">
                            <h:panelGroup>#{sales.name}</h:panelGroup>
                            <h:panelGroup>$#{sales.amount}</h:panelGroup>
                        </c:forEach>
            </h:panelGrid>
        </div>
    </ui:define>
</ui:composition>
